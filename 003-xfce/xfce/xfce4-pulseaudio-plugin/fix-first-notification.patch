From e3f661eb899d2812b5b4e6ebf88fcc932b9eaf73 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?B=C5=82a=C5=BCej=20Szczygie=C5=82?= <mumei6102@gmail.com>
Date: Tue, 15 Apr 2025 18:13:36 +0200
Subject: [PATCH] Fix missing icon on first notification

Amends: df191cdd4422abe4638fa73b9f65e368da537d27

Closes: #119
---
 panel-plugin/pulseaudio-notify.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/panel-plugin/pulseaudio-notify.c b/panel-plugin/pulseaudio-notify.c
index 6695680..3dd26de 100644
--- panel-plugin/pulseaudio-notify.c
+++ panel-plugin/pulseaudio-notify.c
@@ -119,6 +119,9 @@ pulseaudio_notify_init (PulseaudioNotify *notify)
 
   notify_init ("Xfce volume control");
 
+  // Call synchronous function, otherwise we don't see icon in first notification popup...
+  notify_get_server_info (NULL, NULL, NULL, NULL);
+
   notify->notification = notify_notification_new ("xfce4-pulseaudio-plugin", NULL, NULL);
   notify_notification_set_timeout (notify->notification, 2000);
   notify_notification_set_hint (notify->notification, "transient", g_variant_new_boolean (TRUE));
-- 
GitLab
